'use strict';const inHtml=document.getElementById("main"),prixInHtml=document.getElementById("finalPrice"),btnCommande=document.getElementById("btnCom");let data=JSON.parse(localStorage.getItem("basket"));0<localStorage.length?(prixInHtml.innerHTML=calculPrixPanier()+" \u20ac (euros)",data.forEach(a=>{inHtml.innerHTML+=`
            <div class="row m-2 pt-3 panierLine">
                <div class="col-md-3 col-lg-2">
                    <img alt="${a.name}" class="img-fluid" src="${a.image}">
                </div>
                <div class="col-md-4">
                    <a href="produit.html?id=${a._id}"><h2>${a.name}</h2></a>
                    <p><strong>Quantit\u00e9</strong> : ${a.quantite}</p>
                    <p><strong>Lentilles</strong> : ${a.lens}</p>
                </div>
                <div class="col-md-5 col-lg-4"
                    <p class="prixProduitPanier"><strong>Prix : <span>${a.totalPrice} \u20ac</span></strong></p>   
                </div>
                <div class="col-md-1">
                    <button class="btn btn-danger mb-3" onclick="deleteItem('${a._id}')">Supprimer</button>  
                </div>
            </div>
            `})):inHtml.innerHTML='\n        <div class="container-fluid">\n            <img class="center-block gif" alt="" src="images/polizas_gif.gif" />\n            <p class="text-center lead">Votre panier est vide :\'(</p>\n        </div>';function deleteItem(a){const c=data.filter(b=>b._id!==a);localStorage.setItem("basket",JSON.stringify(c));0==c&&localStorage.clear();document.location.href="panier.html"}function calculPrixPanier(){return data.reduce((a,c)=>a+c.totalPrice,0)}
const lastname=document.getElementById("nom "),firstname=document.getElementById("prenom "),address=document.getElementById("adresse "),city=document.getElementById("ville "),email=document.getElementById("email "),form=document.querySelector("#submitForm");
form.addEventListener("submit",a=>{a.preventDefault();a={firstName:firstname.value,lastName:lastname.value,address:address.value,city:city.value,email:email.value};console.log(a);const c=[];a={contact:a,products:c};data.forEach(b=>{c.push(b._id)});a={method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}};""==firstname||""==lastname||""==address||""==city||""==email?alert("Tous les champs doivent \u00eatres remplis !"):fetch("http://localhost:3000/api/cameras/order",a).then(b=>
{if(b.ok)return b.json();Promise.reject(b.status)}).then(b=>{window.location.href=`confirm.html?ncomm=${b.orderId}`}).catch(b=>{alert(b)})});