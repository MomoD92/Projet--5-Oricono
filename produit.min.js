'use strict';const inHtml=document.getElementById("main"),params=new URLSearchParams(window.location.search);
fetch(`http://localhost:3000/api/cameras/${params.get("id")}`).then(a=>{if(a.ok)return data=a.json();Promise.reject(a.status)}).then(a=>{function d(){var b=document.getElementById("inlineFormCustomSelect");const f=document.getElementById("quantiteProduit");let c={_id:a._id,image:a.imageUrl,name:a.name,lens:b.value,quantite:f.value,totalPrice:a.price*parseInt(f.value)/100,price:a.price/100};(b=JSON.parse(localStorage.getItem("basket")))?b.some(e=>e._id===c._id)?(b=b.filter(e=>e._id!==c._id),b.push(c),
localStorage.setItem("basket",JSON.stringify(b))):(b.push(c),localStorage.setItem("basket",JSON.stringify(b))):(b=[],b.push(c),localStorage.setItem("basket",JSON.stringify(b)),window.location.href="panier.html");window.location.href="panier.html"}let g=a.price/100,h="";a.lenses.forEach(b=>{h+=`<option value="${b}">${b}</option>`});inHtml.innerHTML+=`
                <div class="card card-body col-12 col-lg-6">
                    <img alt="${a.name}" class="img-fluid" src="${a.imageUrl}">
                </div>
                <div class="card col-12 col-lg-6 pb-3 bg-gradient-light">
                    <h2>${a.name}</h2>
                    <p>${a.description}</p>
                    <form>
                        <label for="quantiteProduit">Quantit\u00e9:</label>
                        <input id ="quantiteProduit" type="number" min="1" value="1"/>
                            <div class="col-auto my-1 pb-5 mt-4">
                                <label class="mr-sm-2" for="inlineFormCustomSelect">Objectifs</label>
                                <select class="custom-select mr-sm-2" id="inlineFormCustomSelect">
                                    ${h}   
                                </select>        
                            </div>
                        <p><strong>Prix total</strong> : <span id="totalPrice">${g}</span> \u20ac</p>
                        <button id="btnAjoutId" type="button" class="btn btn-success">Ajouter au panier</button>
                    </form>   
                </div>
                `;calculePrice(g);document.getElementById("btnAjoutId").addEventListener("click",()=>{d()})});function calculePrice(a){document.getElementById("quantiteProduit").addEventListener("change",d=>{document.getElementById("totalPrice").textContent=`${a}`*`${d.target.value}`})};